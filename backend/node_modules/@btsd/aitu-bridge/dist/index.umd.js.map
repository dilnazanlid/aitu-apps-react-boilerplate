{"version":3,"file":"index.umd.js","sources":["../src/promisifyMethod.ts","../src/index.ts","../src/promisifyInvoke.ts","../src/promisifyStorage.ts"],"sourcesContent":["function createCounter() {\n  return {\n    current: 0,\n    next() {\n      return ++this.current;\n    },\n  };\n}\n\nfunction createRequestResolver() {\n  type PromiseController = {\n    resolve: (value: any) => any;\n    reject: (reason: any) => any;\n  };\n\n  const counter = createCounter();\n  const promiseControllers: Record<string, PromiseController | null> = {};\n\n  return {\n    add(controller: PromiseController, customId?: number | string): number | string {\n      const id = customId != null ? customId : counter.next();\n      const methodId = id;\n      promiseControllers[methodId] = controller;\n      return methodId;\n    },\n\n    resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n      const requestPromise = promiseControllers[reqId];\n\n      if (requestPromise) {\n        if (isSuccess(error)) {\n          requestPromise.resolve(data);\n        } else {\n          requestPromise.reject(error);\n        }\n\n        promiseControllers[reqId] = null;\n      }\n    },\n  };\n}\n\nfunction promisifyMethod(method, subscribe: (fn: any) => void) {\n  const requestResolver = createRequestResolver();\n\n  subscribe((event) => {\n    if (!event.detail) {\n      return;\n    }\n\n    if ('reqId' in event.detail) {\n      const { reqId, data, error } = event.detail;\n\n      if (reqId) {\n        requestResolver.resolve(reqId, data, (error) => !(error), error);\n      }\n    }\n  });\n\n  return function promisifiedFunc(...args: any[]): Promise<any | void> {\n    return new Promise((resolve, reject) => {\n      const reqId = requestResolver.add({ resolve, reject });\n\n      method(reqId, ...args);\n    });\n  };\n}\n\nexport default promisifyMethod;\n","import promisifyInvoke from './promisifyInvoke';\nimport promisifyStorage from './promisifyStorage';\nimport promisifyMethod from './promisifyMethod';\n\nenum EInvokeRequest {\n  getMe = 'GetMe',\n  getPhone = 'GetPhone',\n  getContacts = 'GetContacts',\n  enableNotifications = 'AllowNotifications',\n  disableNotifications = 'DisableNotifications'\n}\n\ntype SetItemType = (keyName: string, keyValue: string) => Promise<void>;\ntype GetItemType = (keyName: string) => Promise<string | null>;\ntype ClearType = () => Promise<void>;\n\ninterface GetPhoneResponse {\n  phone: string;\n  sign: string;\n}\n\ninterface GetMeResponse {\n  name: string;\n  lastname: string;\n  id: string;\n  avatar?: string;\n  avatarThumb?: string;\n  sign: string;\n}\n\ninterface ResponseObject {\n  phone?: string;\n  name?: string;\n  lastname?: string;\n}\n\ninterface GetGeoResponse {\n  latitude: number;\n  longitude: number;\n}\n\ninterface GetContactsResponse {\n  contacts: Array<{\n    first_name: string;\n    last_name: string;\n    phone: string;\n  }>;\n  sign: string;\n}\n\ninterface SelectContactResponse {\n  phone: string;\n  name: string;\n  lastname: string;\n}\n\ntype OpenSettingsResponse = 'success' | 'failed';\ntype ShareResponse = 'success' | 'failed';\ntype CopyToClipboardResponse = 'success' | 'failed';\ntype VibrateResponse = 'success' | 'failed';\n\ntype BridgeInvoke<T extends EInvokeRequest, R> = (method: T, data?: {}) => Promise<R>;\n\ninterface BridgeStorage {\n  setItem: SetItemType,\n  getItem: GetItemType,\n  clear: ClearType\n}\n\ninterface AituBridge {\n  invoke: BridgeInvoke<EInvokeRequest, ResponseObject>;\n  storage: BridgeStorage;\n  getMe: () => Promise<GetMeResponse>;\n  getPhone: () => Promise<GetPhoneResponse>;\n  getContacts: () => Promise<GetContactsResponse>;\n  getGeo: () => Promise<GetGeoResponse>;\n  selectContact: () => Promise<SelectContactResponse>;\n  getQr: () => Promise<string>;\n  share: (text: string) => Promise<ShareResponse>;\n  copyToClipboard: (text: string) => Promise<CopyToClipboardResponse>;\n  shareImage: (text: string, image: string) => Promise<ShareResponse>;\n  enableNotifications: () => Promise<{}>;\n  disableNotifications: () => Promise<{}>;\n  openSettings: () => Promise<OpenSettingsResponse>;\n  setShakeHandler: (handler: any) => void;\n  vibrate: (pattern: number[]) => Promise<VibratePattern>;\n  isSupported: () => boolean;\n  supports: (method: string) => boolean;\n  sub: any;\n}\n\nconst invokeMethod = 'invoke';\nconst storageMethod = 'storage';\nconst getGeoMethod = 'getGeo';\nconst getQrMethod = 'getQr';\nconst selectContactMethod = 'selectContact';\nconst openSettingsMethod = 'openSettings';\nconst shareMethod = 'share';\nconst copyToClipboardMethod = 'copyToClipboard';\nconst shareImageMethod = 'shareImage';\nconst setShakeHandlerMethod = 'setShakeHandler';\nconst vibrateMethod = 'vibrate';\n\nconst android = typeof window !== 'undefined' && (window as any).AndroidBridge;\nconst ios = typeof window !== 'undefined' && (window as any).webkit && (window as any).webkit.messageHandlers;\nconst web = typeof window !== 'undefined' && (window.top !== window) && ((window as any).WebBridge = (window as any).WebBridge || {});\n\nif (web) {\n  const aituOrigin = (window as any).AITU_ORIGIN || 'https://aitu.io';\n\n  [invokeMethod, storageMethod].forEach((method) => {\n    if (!web[method]) {\n      web[method] = (...args) => window.top.postMessage(JSON.stringify({\n        method,\n        payload: args,\n      }), aituOrigin);\n    }\n  });\n\n  window.addEventListener('message', (event) => {\n    if (event.origin === aituOrigin && event.data) {\n      try {\n        const detail = JSON.parse(event.data);\n        window.dispatchEvent(new CustomEvent('aituEvents', { detail }));\n      } catch(e) {}\n    }\n  });\n}\n\nconst buildBridge = (): AituBridge => {\n  const subs = [];\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('aituEvents', (e: any) => {\n      [...subs].map((fn) => fn.call(null, e));\n    })\n  }\n\n  const invoke = (reqId, method, data = {}) => {\n    const isAndroid = android && android[invokeMethod];\n    const isIos = ios && ios[invokeMethod];\n    const isWeb = web && web[invokeMethod];\n\n    if (isAndroid) {\n      android[invokeMethod](reqId, method, JSON.stringify(data));\n    } else if (isIos) {\n      ios[invokeMethod].postMessage({ reqId, method, data });\n    } else if (isWeb) {\n      web[invokeMethod](reqId, method, data);\n    } else if (typeof window !== 'undefined') {\n      console.log('--invoke-isUnknown');\n    }\n  };\n\n  const storage = (reqId, method, data = {}) => {\n    const isAndroid = android && android[storageMethod];\n    const isIos = ios && ios[storageMethod];\n    const isWeb = web && web[storageMethod];\n\n    if (isAndroid) {\n      android[storageMethod](reqId, method, JSON.stringify(data));\n    } else if (isIos) {\n      ios[storageMethod].postMessage({ reqId, method, data });\n    } else if (isWeb) {\n      web[storageMethod](reqId, method, data);\n    } else if (typeof window !== 'undefined') {\n      console.log('--storage-isUnknown');\n    }\n  }\n\n  const getGeo = (reqId) => {\n    const isAndroid = android && android[getGeoMethod];\n    const isIos = ios && ios[getGeoMethod];\n\n    if (isAndroid) {\n      android[getGeoMethod](reqId);\n    } else if (isIos) {\n      ios[getGeoMethod].postMessage({ reqId });\n    } else if (typeof window !== 'undefined') {\n      console.log('--getGeo-isWeb');\n    }\n  }\n\n  const getQr = (reqId) => {\n    const isAndroid = android && android[getQrMethod];\n    const isIos = ios && ios[getQrMethod];\n\n    if (isAndroid) {\n      android[getQrMethod](reqId);\n    } else if (isIos) {\n      ios[getQrMethod].postMessage({ reqId });\n    } else if (typeof window !== 'undefined') {\n      console.log('--getQr-isWeb');\n    }\n  }\n\n  const selectContact = (reqId) => {\n    const isAndroid = android && android[selectContactMethod];\n    const isIos = ios && ios[selectContactMethod];\n\n    if (isAndroid) {\n      android[selectContactMethod](reqId);\n    } else if (isIos) {\n      ios[selectContactMethod].postMessage({ reqId });\n    } else if (typeof window !== 'undefined') {\n      console.log('--selectContact-isWeb');\n    }\n  }\n\n  const openSettings = (reqId) => {\n    const isAndroid = android && android[openSettingsMethod];\n    const isIos = ios && ios[openSettingsMethod];\n\n    if (isAndroid) {\n      android[openSettingsMethod](reqId);\n    } else if (isIos) {\n      ios[openSettingsMethod].postMessage({ reqId });\n    } else if (typeof window !== 'undefined') {\n      console.log('--openSettings-isWeb');\n    }\n  }\n\n  const share = (reqId, text) => {\n    const isAndroid = android && android[shareMethod];\n    const isIos = ios && ios[shareMethod];\n\n    if (isAndroid) {\n      android[shareMethod](reqId, text);\n    } else if (isIos) {\n      ios[shareMethod].postMessage({ reqId, text });\n    } else if (typeof window !== 'undefined') {\n      console.log('--share-isWeb');\n    }\n  }\n\n\n  const copyToClipboard  = (reqId, text) => {\n    const isAndroid = android && android[copyToClipboardMethod];\n    const isIos = ios && ios[copyToClipboardMethod];\n\n    if (isAndroid) {\n      android[copyToClipboardMethod](reqId, text);\n    } else if (isIos) {\n      ios[copyToClipboardMethod].postMessage({ reqId, text });\n    } else if (typeof window !== 'undefined') {\n      console.log('--copyToClipboard-isWeb');\n    }\n  }\n\n  const shareImage = (reqId, text, image) => {\n    const isAndroid = android && android[shareImageMethod];\n    const isIos = ios && ios[shareImageMethod];\n\n    if (isAndroid) {\n      android[shareImageMethod](reqId, text, image);\n    } else if (isIos) {\n      ios[shareImageMethod].postMessage({ reqId, text, image });\n    } else if (typeof window !== 'undefined') {\n      console.log('--shareImage-isWeb');\n    }\n  }\n\n  const enableNotifications = () => invokePromise(EInvokeRequest.enableNotifications);\n\n  const disableNotifications = () => invokePromise(EInvokeRequest.disableNotifications);\n\n  const setShakeHandler = (handler) => {\n    const isAndroid = android && android[setShakeHandlerMethod];\n    const isIos = ios && ios[setShakeHandlerMethod];\n\n    if (isAndroid || isIos) {\n      (window as any).onAituBridgeShake = handler;\n    } else if (typeof window !== 'undefined') {\n      console.log('--setShakeHandler-isWeb');\n    }\n  };\n\n  const vibrate = (reqId, pattern) => {\n    if (\n      !Array.isArray(pattern) ||\n      pattern.some((timing) => timing < 1 || timing !== Math.floor(timing)) ||\n      pattern.reduce((total, timing) => total + timing) > 10000\n    ) {\n      console.error('Pattern should be an array of positive integers no longer than 10000ms total');\n      return;\n    }\n\n    const isAndroid = android && android[vibrateMethod];\n    const isIos = ios && ios[vibrateMethod];\n\n    if (isAndroid) {\n      android[vibrateMethod](reqId, JSON.stringify(pattern));\n    } else if (isIos) {\n      ios[vibrateMethod].postMessage({ reqId, pattern });\n    } else if (typeof window !== 'undefined') {\n      console.log('--vibrate-isWeb');\n    }\n  }\n\n  const isSupported = () => {\n    return android || ios || web;\n  }\n\n  const supports = (method) =>\n    (android && typeof android[method] === 'function') ||\n    (ios && ios[method] && typeof ios[method].postMessage === 'function') ||\n    (web && typeof web[method] === 'function');\n\n  const sub = (listener: any) => {\n    subs.push(listener);\n  }\n\n  const invokePromise = promisifyInvoke(invoke, sub);\n  const storagePromise = promisifyStorage(storage, sub);\n  const getGeoPromise = promisifyMethod(getGeo, sub);\n  const getQrPromise = promisifyMethod(getQr, sub);\n  const selectContactPromise = promisifyMethod(selectContact, sub);\n  const openSettingsPromise = promisifyMethod(openSettings, sub);\n  const sharePromise = promisifyMethod(share, sub);\n  const copyToClipboardPromise = promisifyMethod(copyToClipboard, sub);\n  const shareImagePromise = promisifyMethod(shareImage, sub);\n  const vibratePromise = promisifyMethod(vibrate, sub);\n\n  return {\n    copyToClipboard: copyToClipboardPromise,\n    invoke: invokePromise,\n    storage: storagePromise,\n    getMe: () => invokePromise(EInvokeRequest.getMe),\n    getPhone: () => invokePromise(EInvokeRequest.getPhone),\n    getContacts: () => invokePromise(EInvokeRequest.getContacts),\n    getGeo: getGeoPromise,\n    getQr: getQrPromise,\n    selectContact: selectContactPromise,\n    enableNotifications,\n    disableNotifications,\n    openSettings: openSettingsPromise,\n    share: sharePromise,\n    shareImage: shareImagePromise,\n    setShakeHandler,\n    vibrate: vibratePromise,\n    isSupported,\n    supports,\n    sub\n  }\n}\n\nconst bridge = buildBridge();\n\nexport default bridge;\n","function createCounter() {\n  return {\n    current: 0,\n    next() {\n      return ++this.current;\n    },\n  };\n}\n\nfunction createRequestResolver() {\n  type PromiseController = {\n    resolve: (value: any) => any;\n    reject: (reason: any) => any;\n  };\n\n  const counter = createCounter();\n  const promiseControllers: Record<string, PromiseController | null> = {};\n\n  return {\n    add(controller: PromiseController, customId?: number | string): number | string {\n      const id = customId != null ? customId : counter.next();\n      const invokeId = id;\n      promiseControllers[invokeId] = controller;\n      return invokeId;\n    },\n\n    resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n      const requestPromise = promiseControllers[reqId];\n\n      if (requestPromise) {\n        if (isSuccess(error)) {\n          requestPromise.resolve(data);\n        } else {\n          requestPromise.reject(error);\n        }\n\n        promiseControllers[reqId] = null;\n      }\n    },\n  };\n}\n\nfunction promisifyInvoke(invoke, subscribe: (fn: any) => void) {\n  const requestResolver = createRequestResolver();\n\n  subscribe((event) => {\n    if (!event.detail) {\n      return;\n    }\n\n    if ('reqId' in event.detail) {\n      const { reqId, data, error } = event.detail;\n\n      if (reqId) {\n        requestResolver.resolve(reqId, data, (error) => !(error), error);\n      }\n    }\n  });\n\n  return function promisifiedFunc(method: any, props: any = {}): Promise<any | void> {\n    return new Promise((resolve, reject) => {\n      const reqId = requestResolver.add({ resolve, reject }, props.reqId);\n\n      invoke(reqId, method, props);\n    });\n  };\n}\n\nexport default promisifyInvoke;\n","function createCounter() {\n    return {\n      current: 0,\n      next() {\n        return ++this.current;\n      },\n    };\n  }\n  \n  function createRequestResolver() {\n    type PromiseController = {\n      resolve: (value: any) => any;\n      reject: (reason: any) => any;\n    };\n  \n    const counter = createCounter();\n    const promiseControllers: Record<string, PromiseController | null> = {};\n  \n    return {\n      add(controller: PromiseController, customId?: number | string): number | string {\n        const id = customId != null ? customId : counter.next();\n        const storageId = `s${id}`;\n        promiseControllers[storageId] = controller;\n        return storageId;\n      },\n  \n      resolve<T>(reqId: number | string, data: T, isSuccess: (data: T) => boolean, error: any) {\n        const requestPromise = promiseControllers[reqId];\n  \n        if (requestPromise) {\n          if (isSuccess(error)) {\n            requestPromise.resolve(data);\n          } else {\n            requestPromise.reject(error);\n          }\n  \n          promiseControllers[reqId] = null;\n        }\n      },\n    };\n  }\n  \n  function promisifyStorage(storage, subscribe: (fn: any) => void) {\n    const requestResolver = createRequestResolver();\n  \n    subscribe((event) => {\n      if (!event.detail) {\n        return;\n      }\n  \n      if ('reqId' in event.detail) {\n        const { reqId, data, error } = event.detail;\n  \n        if (reqId) {\n          requestResolver.resolve(reqId, data, (error) => !(error), error);\n        }\n      }\n    });\n\n    return {\n      setItem: (keyName: string, keyValue: string): Promise<void> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'setItem', { keyName, keyValue });\n        });\n      },\n      getItem: (keyName: string): Promise<string | null> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'getItem', { keyName });\n        });\n      },\n      clear: (): Promise<void> => {\n        return new Promise((resolve, reject) => {\n          const reqId = requestResolver.add({ resolve, reject });\n          storage(reqId, 'clear', {});\n        });\n      },\n    }\n  }\n  \n  export default promisifyStorage;\n  "],"names":["promisifyMethod","method","subscribe","counter","promiseControllers","requestResolver","current","next","this","add","controller","customId","methodId","resolve","reqId","data","isSuccess","error","requestPromise","reject","event","detail","Promise","EInvokeRequest","invokeMethod","storageMethod","android","window","AndroidBridge","ios","webkit","messageHandlers","web","top","WebBridge","aituOrigin","AITU_ORIGIN","forEach","postMessage","JSON","stringify","payload","addEventListener","origin","parse","dispatchEvent","CustomEvent","e","subs","map","fn","call","sub","listener","push","invokePromise","invokeId","props","isIos","isWeb","console","log","invoke","storagePromise","storage","storageId","setItem","keyName","keyValue","getItem","clear","promisifyStorage","getGeoPromise","getQrPromise","selectContactPromise","openSettingsPromise","sharePromise","text","copyToClipboardPromise","shareImagePromise","image","vibratePromise","pattern","Array","isArray","some","timing","Math","floor","reduce","total","copyToClipboard","getMe","getPhone","getContacts","getGeo","getQr","selectContact","enableNotifications","disableNotifications","openSettings","share","shareImage","setShakeHandler","handler","onAituBridgeShake","vibrate","isSupported","supports","buildBridge"],"mappings":"mLA0CA,SAASA,EAAgBC,EAAQC,GAC/B,IA5BMC,EACAC,EA2BAC,GA5BAF,EAdC,CACLG,QAAS,EACTC,gBACE,QAASC,KAAKF,UAYZF,EAA+D,GAE9D,CACLK,aAAIC,EAA+BC,GACjC,IACMC,EADiB,MAAZD,EAAmBA,EAAWR,EAAQI,OAGjD,OADAH,EAAmBQ,GAAYF,EACxBE,GAGTC,iBAAWC,EAAwBC,EAASC,EAAiCC,GAC3E,IAAMC,EAAiBd,EAAmBU,GAEtCI,IACEF,EAAUC,GACZC,EAAeL,QAAQE,GAEvBG,EAAeC,OAAOF,GAGxBb,EAAmBU,GAAS,SAuBlC,OAdAZ,EAAU,SAACkB,GACT,GAAKA,EAAMC,QAIP,UAAWD,EAAMC,OAAQ,OACID,EAAMC,OAA7BP,IAAAA,MAEJA,GACFT,EAAgBQ,QAAQC,IAHXC,KAGwB,SAACE,UAAYA,KAH/BA,qCASvB,WAAWK,QAAQ,SAACT,EAASM,GAC3B,IAAML,EAAQT,EAAgBI,IAAI,CAAEI,QAAAA,EAASM,OAAAA,IAE7ClB,gBAAOa,gCC3Db,IAAKS,GAAL,SAAKA,GACHA,gBACAA,sBACAA,4BACAA,2CACAA,8CALF,CAAKA,IAAAA,OAuFL,IAAMC,EAAe,SACfC,EAAgB,UAWhBC,EAA4B,oBAAXC,QAA2BA,OAAeC,cAC3DC,EAAwB,oBAAXF,QAA2BA,OAAeG,QAAWH,OAAeG,OAAOC,gBACxFC,EAAwB,oBAAXL,QAA2BA,OAAOM,MAAQN,SAAaA,OAAeO,UAAaP,OAAeO,WAAa,IAElI,GAAIF,EAAK,CACP,IAAMG,EAAcR,OAAeS,aAAe,kBAElD,CAACZ,EAAcC,GAAeY,QAAQ,SAACpC,GAChC+B,EAAI/B,KACP+B,EAAI/B,GAAU,kBAAa0B,OAAOM,IAAIK,YAAYC,KAAKC,UAAU,CAC/DvC,OAAAA,EACAwC,mCACEN,OAIRR,OAAOe,iBAAiB,UAAW,SAACtB,GAClC,GAAIA,EAAMuB,SAAWR,GAAcf,EAAML,KACvC,IACE,IAAMM,EAASkB,KAAKK,MAAMxB,EAAML,MAChCY,OAAOkB,cAAc,IAAIC,YAAY,aAAc,CAAEzB,OAAAA,KACrD,MAAM0B,cAKM,WAClB,IAAMC,EAAO,GAES,oBAAXrB,QACTA,OAAOe,iBAAiB,aAAc,SAACK,GACrC,UAAIC,GAAMC,IAAI,SAACC,UAAOA,EAAGC,KAAK,KAAMJ,OAIxC,IC3HM5C,EACAC,EA2BAC,EDyQA+C,EAAM,SAACC,GACXL,EAAKM,KAAKD,IAGNE,GCzSApD,EAdC,CACLG,QAAS,EACTC,gBACE,QAASC,KAAKF,UAYZF,EAA+D,GA2B/DC,EAzBC,CACLI,aAAIC,EAA+BC,GACjC,IACM6C,EADiB,MAAZ7C,EAAmBA,EAAWR,EAAQI,OAGjD,OADAH,EAAmBoD,GAAY9C,EACxB8C,GAGT3C,iBAAWC,EAAwBC,EAASC,EAAiCC,GAC3E,IAAMC,EAAiBd,EAAmBU,GAEtCI,IACEF,EAAUC,GACZC,EAAeL,QAAQE,GAEvBG,EAAeC,OAAOF,GAGxBb,EAAmBU,GAAS,QDoRYsC,EC3QpC,SAAChC,GACT,GAAKA,EAAMC,QAIP,UAAWD,EAAMC,OAAQ,OACID,EAAMC,OAA7BP,IAAAA,MAEJA,GACFT,EAAgBQ,QAAQC,IAHXC,KAGwB,SAACE,UAAYA,KAH/BA,mBAQOhB,EAAawD,GAC3C,gBAD2CA,IAAAA,EAAa,QAC7CnC,QAAQ,SAACT,EAASM,ID8EhB,SAACL,EAAOb,EAAQc,YAAAA,IAAAA,EAAO,IACpC,IACM2C,EAAQ7B,GAAOA,EAAIL,GACnBmC,EAAQ3B,GAAOA,EAAIR,GAFPE,GAAWA,EAAQF,GAKnCE,EAAQF,GAAcV,EAAOb,EAAQsC,KAAKC,UAAUzB,IAC3C2C,EACT7B,EAAIL,GAAcc,YAAY,CAAExB,MAAAA,EAAOb,OAAAA,EAAQc,KAAAA,IACtC4C,EACT3B,EAAIR,GAAcV,EAAOb,EAAQc,GACN,oBAAXY,QAChBiC,QAAQC,IAAI,sBCvFZC,CAFczD,EAAgBI,IAAI,CAAEI,QAAAA,EAASM,OAAAA,GAAUsC,EAAM3C,OAE/Cb,EAAQwD,OD0PpBM,EE/QN,SAA0BC,EAAS9D,GACjC,IA5BMC,EACAC,EA2BAC,GA5BAF,EAdC,CACLG,QAAS,EACTC,gBACE,QAASC,KAAKF,UAYZF,EAA+D,GAE9D,CACLK,aAAIC,EAA+BC,GACjC,IACMsD,OADiB,MAAZtD,EAAmBA,EAAWR,EAAQI,QAGjD,OADAH,EAAmB6D,GAAavD,EACzBuD,GAGTpD,iBAAWC,EAAwBC,EAASC,EAAiCC,GAC3E,IAAMC,EAAiBd,EAAmBU,GAEtCI,IACEF,EAAUC,GACZC,EAAeL,QAAQE,GAEvBG,EAAeC,OAAOF,GAGxBb,EAAmBU,GAAS,SAuBlC,OAdAZ,EAAU,SAACkB,GACT,GAAKA,EAAMC,QAIP,UAAWD,EAAMC,OAAQ,OACID,EAAMC,OAA7BP,IAAAA,MAEJA,GACFT,EAAgBQ,QAAQC,IAHXC,KAGwB,SAACE,UAAYA,KAH/BA,UAQlB,CACLiD,QAAS,SAACC,EAAiBC,GACzB,WAAW9C,QAAQ,SAACT,EAASM,GAC3B,IAAML,EAAQT,EAAgBI,IAAI,CAAEI,QAAAA,EAASM,OAAAA,IAC7C6C,EAAQlD,EAAO,UAAW,CAAEqD,QAAAA,EAASC,SAAAA,OAGzCC,QAAS,SAACF,GACR,WAAW7C,QAAQ,SAACT,EAASM,GAC3B,IAAML,EAAQT,EAAgBI,IAAI,CAAEI,QAAAA,EAASM,OAAAA,IAC7C6C,EAAQlD,EAAO,UAAW,CAAEqD,QAAAA,OAGhCG,MAAO,WACL,WAAWhD,QAAQ,SAACT,EAASM,GAC3B,IAAML,EAAQT,EAAgBI,IAAI,CAAEI,QAAAA,EAASM,OAAAA,IAC7C6C,EAAQlD,EAAO,QAAS,QF8OTyD,CA/JP,SAACzD,EAAOb,EAAQc,YAAAA,IAAAA,EAAO,IACrC,IACM2C,EAAQ7B,GAAOA,EAAIJ,GACnBkC,EAAQ3B,GAAOA,EAAIP,GAFPC,GAAWA,EAAQD,GAKnCC,EAAQD,GAAeX,EAAOb,EAAQsC,KAAKC,UAAUzB,IAC5C2C,EACT7B,EAAIJ,GAAea,YAAY,CAAExB,MAAAA,EAAOb,OAAAA,EAAQc,KAAAA,IACvC4C,EACT3B,EAAIP,GAAeX,EAAOb,EAAQc,GACP,oBAAXY,QAChBiC,QAAQC,IAAI,wBAmJiCT,GAC3CoB,EAAgBxE,EAhJP,SAACc,GACd,IACM4C,EAAQ7B,GAAOA,EAAG,OADNH,GAAWA,EAAO,OAIlCA,EAAO,OAAeZ,GACb4C,EACT7B,EAAG,OAAeS,YAAY,CAAExB,MAAAA,IACL,oBAAXa,QAChBiC,QAAQC,IAAI,mBAuI8BT,GACxCqB,EAAezE,EApIP,SAACc,GACb,IACM4C,EAAQ7B,GAAOA,EAAG,MADNH,GAAWA,EAAO,MAIlCA,EAAO,MAAcZ,GACZ4C,EACT7B,EAAG,MAAcS,YAAY,CAAExB,MAAAA,IACJ,oBAAXa,QAChBiC,QAAQC,IAAI,kBA2H4BT,GACtCsB,EAAuB1E,EAxHP,SAACc,GACrB,IACM4C,EAAQ7B,GAAOA,EAAG,cADNH,GAAWA,EAAO,cAIlCA,EAAO,cAAsBZ,GACpB4C,EACT7B,EAAG,cAAsBS,YAAY,CAAExB,MAAAA,IACZ,oBAAXa,QAChBiC,QAAQC,IAAI,0BA+G4CT,GACtDuB,EAAsB3E,EA5GP,SAACc,GACpB,IACM4C,EAAQ7B,GAAOA,EAAG,aADNH,GAAWA,EAAO,aAIlCA,EAAO,aAAqBZ,GACnB4C,EACT7B,EAAG,aAAqBS,YAAY,CAAExB,MAAAA,IACX,oBAAXa,QAChBiC,QAAQC,IAAI,yBAmG0CT,GACpDwB,EAAe5E,EAhGP,SAACc,EAAO+D,GACpB,IACMnB,EAAQ7B,GAAOA,EAAG,MADNH,GAAWA,EAAO,MAIlCA,EAAO,MAAcZ,EAAO+D,GACnBnB,EACT7B,EAAG,MAAcS,YAAY,CAAExB,MAAAA,EAAO+D,KAAAA,IACX,oBAAXlD,QAChBiC,QAAQC,IAAI,kBAuF4BT,GACtC0B,EAAyB9E,EAnFN,SAACc,EAAO+D,GAC/B,IACMnB,EAAQ7B,GAAOA,EAAG,gBADNH,GAAWA,EAAO,gBAIlCA,EAAO,gBAAwBZ,EAAO+D,GAC7BnB,EACT7B,EAAG,gBAAwBS,YAAY,CAAExB,MAAAA,EAAO+D,KAAAA,IACrB,oBAAXlD,QAChBiC,QAAQC,IAAI,4BA0EgDT,GAC1D2B,EAAoB/E,EAvEP,SAACc,EAAO+D,EAAMG,GAC/B,IACMtB,EAAQ7B,GAAOA,EAAG,WADNH,GAAWA,EAAO,WAIlCA,EAAO,WAAmBZ,EAAO+D,EAAMG,GAC9BtB,EACT7B,EAAG,WAAmBS,YAAY,CAAExB,MAAAA,EAAO+D,KAAAA,EAAMG,MAAAA,IACtB,oBAAXrD,QAChBiC,QAAQC,IAAI,uBA8DsCT,GAChD6B,EAAiBjF,EA5CP,SAACc,EAAOoE,GACtB,IACGC,MAAMC,QAAQF,IACfA,EAAQG,KAAK,SAACC,UAAWA,EAAS,GAAKA,IAAWC,KAAKC,MAAMF,MAC7DJ,EAAQO,OAAO,SAACC,EAAOJ,UAAWI,EAAQJ,IAAU,IAEpD1B,QAAQ3C,MAAM,oFALhB,CASA,IACMyC,EAAQ7B,GAAOA,EAAG,QADNH,GAAWA,EAAO,QAIlCA,EAAO,QAAgBZ,EAAOyB,KAAKC,UAAU0C,IACpCxB,EACT7B,EAAG,QAAgBS,YAAY,CAAExB,MAAAA,EAAOoE,QAAAA,IACb,oBAAXvD,QAChBiC,QAAQC,IAAI,qBA0BgCT,GAEhD,MAAO,CACLuC,gBAAiBb,EACjBhB,OAAQP,EACRS,QAASD,EACT6B,MAAO,kBAAMrC,EAAchC,EAAeqE,QAC1CC,SAAU,kBAAMtC,EAAchC,EAAesE,WAC7CC,YAAa,kBAAMvC,EAAchC,EAAeuE,cAChDC,OAAQvB,EACRwB,MAAOvB,EACPwB,cAAevB,EACfwB,oBAvE0B,kBAAM3C,EAAchC,EAAe2E,sBAwE7DC,qBAtE2B,kBAAM5C,EAAchC,EAAe4E,uBAuE9DC,aAAczB,EACd0B,MAAOzB,EACP0B,WAAYvB,EACZwB,gBAxEsB,SAACC,GACL9E,GAAWA,EAAO,iBACtBG,GAAOA,EAAG,gBAGrBF,OAAe8E,kBAAoBD,EACT,oBAAX7E,QAChBiC,QAAQC,IAAI,4BAkEd6C,QAASzB,EACT0B,YAzCkB,WAClB,OAAOjF,GAAWG,GAAOG,GAyCzB4E,SAtCe,SAAC3G,UACfyB,GAAsC,mBAApBA,EAAQzB,IAC1B4B,GAAOA,EAAI5B,IAA8C,mBAA5B4B,EAAI5B,GAAQqC,aACzCN,GAA8B,mBAAhBA,EAAI/B,IAoCnBmD,IAAAA,GAIWyD"}